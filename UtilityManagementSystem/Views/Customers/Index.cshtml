@model IEnumerable<UtilityManagementSystem.ViewModels.CustomersViewModel>

<div class="d-flex flex-row justify-content-between">
    <h2>Customers</h2>

    <a class="btn btn-success mb-2" asp-action="Create">Add Customer</a>
</div>


<input type="text" id="searchInput" class="form-control mb-2" placeholder="Search..." />

<div class="container-fluid ums-container ums-content">
    <div class="card shadow-sm rounded-4 card-hover overflow-hidden mt-3">
        <div class="table-responsive">
            <table class="table table-dark table-striped align-middle mb-0">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>City</th>
                        <th>Contact</th>
                        <th>Outstanding</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="customersTable">
                    @foreach (var c in Model)
                    {
                        <tr>
                            <td>@c.Name</td>
                            <td>@c.Type</td>
                            <td>@c.City</td>
                            <td>@c.Contact</td>
                            <td>@c.Outstanding.ToString("C")</td>
                            <td>
                                <button class="btn btn-sm @(c.IsActive ? "btn-outline-danger" : "btn-outline-success")">
                                    @(c.IsActive ? "Inactive" : "Active")
                                </button>
                            </td>
                            <td>
                                <a asp-action="Details" asp-route-id="@c.CustomerID" class="btn btn-primary btn-sm">Details</a>
                                <a asp-action="Edit" asp-route-id="@c.CustomerID" class="btn btn-primary btn-sm">Edit</a>

                                <form asp-action="ToggleActive" method="post" style="display:inline">
                                    <input type="hidden" name="id" value="@c.CustomerID" />

                                    <button class="btn btn-sm @(c.IsActive ? "btn-danger" : "btn-success")">
                                        @(c.IsActive ? "Deactivate" : "Activate")
                                    </button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    document.getElementById('searchInput').addEventListener('keyup', function () {
        let value = this.value.toLowerCase();
        document.querySelectorAll('#customersTable tr').forEach(row => {
            row.style.display = row.textContent.toLowerCase().includes(value) ? '' : 'none';
        });
    });
</script>
